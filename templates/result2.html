{% extends "layout.html" %}
{% block app %}

  <p>The Average Cohen's d is: {{ave_d}}<br> The Standard Error is: {{ave_SEd}}<br> 95% CI=[{{lower_dd}},{{upper_dd}}]</p>

  <p></p>

  <p>The Average Hedges's g is: {{ave_g}}<br> The Standard Error is: {{ave_SEg}}<br> 95% CI=[{{lower_gg}},{{upper_gg}}]</p>
  <p> </p>
  <p>The Heterogeneity of the analysis is: {{Het}}%</p>


  <div style="overflow-x:auto;">
      {{total}}
  </div>


  <p></p>
  <p></p>
    <a href="/return-file/" target="blank"><button class="btn btn-default" name="button">Please Click to Download the results as an Excel file</button></a>

<div id="forestplot"></div>
<p></p>
<div id="pash">

</div>
{% endblock %}
{% block script %}

<script src="https://cdn.plot.ly/plotly-latest.min.js"></script>
<script>

    var study = ["{{study_list |safe}}"];
    study = study[0].substring(1, study[0].length - 1);
    study = study.split(",");

    console.log(study);
    var d = ['{{d_list}}'];
    d = JSON.parse(d);
    var d_lower = ['{{d_lower_list}}'];
    d_lower = JSON.parse(d_lower);
    var d_upper = ['{{d_upper_list}}'];
    d_upper = JSON.parse(d_upper);


    var list = [];

    for (var i = 0; i < d.length; i++) {
        list[i] = {
            x: [d_lower[i],d[i]-0.3,d[i]-0.2,d[i]-0.1, d[i],d[i]+0.1,d[i]+0.2,d[i]+0.3 ,d_upper[i]],
            type: 'box',
            name: study[i]
        };
    }

    var ave_d = {
      x: [{{lower_dd}}, {{ave_d}}, {{upper_dd}}],
      type: 'box',
      name: 'Average Effect Size'
    };

    list.push(ave_d);
    list.reverse()
    var data = list;

    var layout = {
        title: 'Forest Plot'
    };

    Plotly.newPlot('forestplot', data, layout);
    document.getElementById("forestplot").style.overflowX = "scroll";
</script>
{% endblock %}
