{% extends "layout.html" %}
{% block app %}

<a href="/return-file-ratioxl/" target="blank">
  <h5 align="center">Please Click to Download the results as an Excel file</h5>
</a>
<p></p>
<h4>Table.1 summary of studies</h4>
<div style="overflow-x:auto;">
      {{result_table}}
</div>


<p></p>
<h4>Table.2 Summary of results - fixed and random effect models</h4>
<div id="table" align="left">
  <table style="width:100%">
    <thead>
      <tr>
        <td>
          <center> <b> <font color="black">  </font> </b> </center>
        </td>

        <td>
          <center>
            <font color="#2E9AFE"> Ln(Risk Ratio average) </font>
          </center>
        </td>
        <td>
          <center>
            <font color="#2E9AFE"> Risk Ratio average </font>
          </center>
        </td>
        <td>
          <center>
            <font color="#2E9AFE"> SE </center>
          </font>
        </td>
        <td>
          <center>
            <font color="#2E9AFE"> 95%CI </font>
          </center>
        </td>
        <td>
          <center>
            <font color="#2E9AFE"> z score </font>
          </center>
        </td>
        <td>
          <center>
            <font color="#2E9AFE"> p value </font>
          </center>
        </td>
        <td>
          <center>
            <font color="#2E9AFE"> Heterogeneity (I<sup>2</sup>) </font>
          </center>
        </td>

      </tr>
    </thead>
    <tbody>
      <tr>
        <td> <center> <font color="#FF9900"> Fixed Effect Model </font> </center> </td>
        <td> <center>{{LnRR_total_fixed}}</center> </td>
        <td> <center>{{RRave_fixed}}</center> </td>
        <td> <center>{{se_total_fixed}} </center></td>
        <td> <center>[{{lower_RRave_fixed}},{{upper_RRave_fixed}}] </center></td>
        <td> <center>{{z_score_fixed}} </center></td>
        <td> <center>{{p_value_fixed}} </center></td>
        <td> <center>{{Het_fixed}}% </center></td>
      </tr>
      <tr>
        <td> <center> <font color="#FF9900"> Random Effect Model </font> </center> </td>
        <td> <center>{{LnRR_total_random}}</center> </td>
        <td> <center>{{RRave_random}}</center> </td>
        <td> <center>{{se_total_random}} </center></td>
        <td> <center>[{{lower_RRave_random}},{{upper_RRave_random}}] </center></td>
        <td> <center>{{z_score_random}} </center></td>
        <td> <center>{{p_value_random}} </center></td>
        <td> <center>{{Het_random}}%, T<sup>2</sup>={{t2}} </center></td>
      </tr>
    </tbody>
  </table>
</div>

<div class="forest">
      <h4> Fig.1 Forestplot - fixed and random effect models</h4>

      <div id="chartdiv"></div>
      <div id="chart2div"></div>
</div>

<div class="regress" style="display:inline-block;">
  <p></p>
  <h4>Table.3 Results of Meta regression </h4>
  <p></p>
  <div style="overflow-x:auto;">
        {{moder | safe}}
  </div>
</div>
  <p></p>
  <p></p>

<br>

<p></p>

{% endblock %}
{% block script %}
<script>
        const study = {{study_list | safe}}
        const rr = {{RR_list}}
        const rr_lower = {{lower_RR_list}}
        const rr_upper = {{upper_RR_list}}
        const rrf_w = {{weight_fixed_list}}
        const rr_w = {{weight_random_list}}
        const list = []
        var s=[]
        s.push({
        "category": "",
        "measure": 0,
        "bullet": "",
        "bulletSize": 0,
        "high": 0,
        "low": 0
        })
        for (var i=0; i<rr.length; i++) {
         s.push({
            "category": study[i],
            "measure": rr[i].toFixed(3),
            "bullet": "square",
            "bulletSize": rrf_w[i].toFixed(0),
            "high": rr_upper[i].toFixed(3),
            "low": rr_lower[i].toFixed(3)
            })}
            s.push({
               "category": "g(ave) fixed model",
               "measure": {{RRave_fixed}},
               "bullet": "diamond",
               "bulletSize": 25,
               "high": {{upper_RRave_fixed}},
               "low": {{lower_RRave_fixed}}
               })
        var chart = AmCharts.makeChart("chartdiv", {
        "type": "serial",
        "theme": "light",
        "rotate": true,
        "fontSize": 18,
        "categoryAxis": {
        "gridAlpha": 0,
        },
        "valueAxes": [{
        "guides": [{
        "value": 2.2,
        "dashLength": 3,
        "lineThickness": 2
        }]
        }],
        "chartCursor": {
        "fullWidth": true,
        "graphBulletSize": 1,
        "categoryBalloonEnabled": false,
        "cursorAlpha": 0.1
        },
        "dataProvider": s,
        "graphs": [{
        "lineAlpha": 0,
        "bulletField": "bullet",
        "bulletSizeField": "bulletSize",
        "valueField": "measure",
        "lineColor": "#00c20d",
        "balloonText": "<strong>[[value]]</strong> 95%CI([[low]],[[high]])"
        }, {
        "type": "ohlc",
        "highField": "high",
        "lowField": "low",
        "openField": "measure",
        "closeField": "measure",
        "fixedColumnWidth": 1,
        "lineColor": "#00c20d",
        "showBalloon": false
        }],
        "categoryField": "category"
        });
        var t=[]
        t.push({
        "category": "",
        "measure": 0,
        "bullet": "",
        "bulletSize": 0,
        "high": 0,
        "low": 0
        })
        for (var i=0; i<rr.length; i++) {
         t.push({
            "category": study[i],
            "measure": rr[i].toFixed(3),
            "bullet": "square",
            "bulletSize": rr_w[i].toFixed(0),
            "high": rr_upper[i].toFixed(3),
            "low": rr_lower[i].toFixed(3)
            })}
            t.push({
               "category": "g(ave) random model",
               "measure": {{RRave_random}},
               "bullet": "diamond",
               "bulletSize": 25,
               "high": {{upper_RRave_random}},
               "low": {{lower_RRave_random}}
               })
        var chart = AmCharts.makeChart("chart2div", {
        "type": "serial",
        "theme": "light",
        "rotate": true,
        "fontSize": 18,
        "categoryAxis": {
        "gridAlpha": 0,
        },
        "valueAxes": [{
        "guides": [{
        "value": 2.2,
        "dashLength": 3,
        "lineThickness": 2
        }]
        }],
        "chartCursor": {
        "fullWidth": true,
        "graphBulletSize": 1,
        "categoryBalloonEnabled": false,
        "cursorAlpha": 0.1
        },
        "dataProvider": t,
        "graphs": [{
        "lineAlpha": 0,
        "bulletField": "bullet",
        "bulletSizeField": "bulletSize",
        "valueField": "measure",
        "lineColor": "#00c20d",
        "balloonText": "<strong>[[value]]</strong> 95%CI([[low]],[[high]])"
        }, {
        "type": "ohlc",
        "highField": "high",
        "lowField": "low",
        "openField": "measure",
        "closeField": "measure",
        "fixedColumnWidth": 1,
        "lineColor": "#00c20d",
        "showBalloon": false
        }],
        "categoryField": "category"
        });
</script>
{% endblock %}
